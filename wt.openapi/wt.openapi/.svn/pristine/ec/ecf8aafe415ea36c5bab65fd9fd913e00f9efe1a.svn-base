<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<script type="text/javascript" src="/resources/js/jquery-3.1.0.min.js"></script>
	<script type="text/javascript" src="/resources/js/jquery-migrate-1.4.1.min.js"></script>
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
</head>
<body>
<div data-role="page">
	<form name="regfrm" id="regfrm" action="register" method="post">
	<table style="margin-left:10px">
		<tr>
		  <td>Email</td><td><input type="email" name="userId" id="userId"></td>
		  <td><input type="button" id="chkId" value="중복확인"></td>
		</tr>
		<tr>
			<td></td><td colspan="2"><label id="checkId"></label></td>
		</tr>
		<tr>
		  <td>비밀번호</td><td><input type="password" name="password" id="memPassword"></td>
		</tr>
		<tr>
		  <td></td><td colspan="2"><label id="availPwd"></label></td>
		</tr>
		<tr>
		  <td>비밀번호 확인　</td><td><input type="password" name="chkPassword" id="chkPassword"></td>
		</tr>
		<tr>
		  <td></td><td><label id="checkPwd"></label></td>
		</tr>
		<tr>
		  <td>이름</td><td><input type="text" name="name" id="memName"></td>
		</tr>
		<tr>
		  <td>연락처</td><td><input type="tel" name="phone" id="memPhone"></td><td>( '-' 제외 )</td>
		</tr>
		<tr>
		  <td>닉네임</td><td><input type="text" name="nickName" id="memNickname"></td>
		</tr>
		<tr><br><br><br></tr>
		<tr>
			<td>성별</td>
			<td>
				<fieldset data-role="controlgroup" data-type="horizontal">
				    <input type="radio" name="sex" id="memSex" value="M" onclick="checkValue();" />
				    <label for="memSex">남</label>
				    <input type="radio" name="sex" id="memSex2" value="F" onclick="checkValue();"/>
				    <label for="memSex2">여</label>
				</fieldset>
			</td>
		</tr>
		<tr><td></td><td></td></tr>
	</table>
	<input type="submit" value="회원가입">
	</form>
</div>
</body>
<script>
	var idcheck = false;
	var pwdcheck = false;
	var id;
	
	$("#regfrm").submit(function() {
		var id2 = $("#userId").val();
		var sex = $('input:radio[name=sex]:checked').val();
		
		if(!idcheck || id2 != id)
		{
			alert('아이디 중복체크를 해주세요');
			return false;
		}
		else if(!pwdcheck)
		{
			alert('비밀번호를 다시 입력해주세요');
			return false;
			
		}
		else if(typeof sex == "undefined")
		{
			alert('성별을 선택해주세요');
			return false;
			
		}
		else
		{
			alert('회원가입성공');
		}
		
	});
	
	$("#chkId").click(function() {
		var userId = $('#userId').val();
		id = userId;
		$.ajax({
			url: "/openapi/member/checkId",
			type: "post",
			data: {userId : userId},
			dataType:'json',
			success: function(data){
				var resultCode = data.result;
				if(data.result.code == 200)
				{
					document.getElementById("checkId").innerHTML = "사용 가능한 아이디입니다.";
					$("#checkId").css("color", "green");
					idcheck=true;
				}
				else
				{
					document.getElementById("checkId").innerHTML = "이미 가입된 아이디입니다.";	
					$("#checkId").css("color", "red");
					idcheck=false;
				}
			},
			error : function(error){
				alert(error.statusText);
			}
		});
		
		return false;
	});
	
	$("#chkPassword").keyup(function(){
		var pwd = $("#memPassword").val();
		var re_pwd = $("#chkPassword").val();
		
		if(pwd != re_pwd)
		{
			document.getElementById("checkPwd").innerHTML = "비밀번호가 틀립니다.";
			$("#checkPwd").css("color", "red");
			pwdcheck=false;
		}
		else
		{
			document.getElementById("checkPwd").innerHTML = "비밀번호가 일치합니다.";
			$("#checkPwd").css("color", "green");
			pwdcheck=true;
		}
		
		return false;
	});
	
	$("#memPassword").keyup(function(){
		var pwd = $("#memPassword").val();
		var re_pwd = $("#chkPassword").val();
		var pattern1=/[0-9]/;
		var pattern2=/[a-zA-Z]/;
		var pattern3=/[!@#$%^*+=-]/;
		if(pwd != '')
		{
			if(!pattern1.test(pwd) || !pattern2.test(pwd) || !pattern3.test(pwd) || pwd.length < 8)
			{
				document.getElementById("availPwd").innerHTML = "비밀번호는 영문, 숫자, 특수기호 8자리 이상으로 구성하여야 합니다.";		
			}
			else
			{
				document.getElementById("availPwd").innerHTML = "";
			}
			
			if(re_pwd != '')
			{
				if(pwd != re_pwd)
				{
					document.getElementById("checkPwd").innerHTML = "비밀번호가 틀립니다.";
					$("#checkPwd").css("color", "red");
					pwdcheck=false;
				}
				else
				{
					document.getElementById("checkPwd").innerHTML = "비밀번호가 일치합니다.";
					$("#checkPwd").css("color", "green");
					pwdcheck=true;
				}
			}
		}
		return false;
	});
<%-- 	
	$.ajax({
	    url : "<%=mwebHostSSL%>/api/member/login.do",
	    data : {
	     loginId : loginId,
	     pw : pw
	    },
	    dataType : "json",
	      success: function(data){
	       var resultCode = data.resultCode;
	       
	       if( resultCode == "200"){
	       }else if ( resultCode == "2115" ){
	        alert('이메일 미인증 상태입니다. 가입하신 One ID 계정에 접속하셔서 이메일 인증 완료 후 로그인 해 주시기 바랍니다.');
	       }else if ( resultCode == "7033" ){
	        alert('이메일 미인증 상태입니다. 자세한 내용은 고객센터에 문의 바랍니다.');
	       }else if(resultCode == '2200' || resultCode == '2201' ) {
	         alert('아이디 또는 비밀번호를 다시 확인하세요.');
	       }else if(resultCode == '7023' || resultCode == '5500' || resultCode == '5002'){ 
	         alert('서버접속이 지연되고 있습니다. 잠시 후 이용해 주시기 바랍니다.');
	       } else if(resultCode == '2222'){ 
	        alert("죄송합니다. \n회원님께서는 로그인 오류 허용횟수를 초과(5회) 하셨습니다.");
	       }else{
	        alert('로그인에 실패 했습니다. 잠시 후 이용해 주시기 바랍니다.');
	       }
	       
	       landingAjax('login', '', resultCode);
	      },
	      error: function(xhr, ajaxOptions, thrownError){
	       landingAjax('login', 'ajaxFail', '');
	       alert('로그인에 실패 했습니다. 잠시 후 이용해 주시기 바랍니다.');
	       }
	           
	   });
 --%>
</script>
</html>
