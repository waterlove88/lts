package com.wt.openapi.utils;

import java.util.Properties;

import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

import com.wt.openapi.common.configuration.ConfigProperties;


public class SendEmailUtils {

	public void SendEmailAuth(String emailAuthKey, String toAddress, String memNo) throws Exception {
		String host = ConfigProperties.getProperty("email.host");
		String username = ConfigProperties.getProperty("email.from.address");
		String password = ConfigProperties.getProperty("email.password");
		 
		// 메일 내용
		String subject = ConfigProperties.getProperty("email.auth.subject");
		String body = ConfigProperties.getProperty("email.auth.contents")+"\n"
						+ConfigProperties.getProperty("email.auth.host")+emailAuthKey+"&memNo="+memNo;
		
		//properties 설정
		Properties props = new Properties();
		props.put("mail.smtps.auth", "true");
		// 메일 세션
        Session session = Session.getDefaultInstance(props);
        MimeMessage msg = new MimeMessage(session);
 
        // 메일 관련
        msg.setSubject(subject);
        msg.setText(body);
        msg.setFrom(new InternetAddress(username));
        msg.addRecipient(Message.RecipientType.TO, new InternetAddress(toAddress));
		 
		// 발송
		Transport transport = session.getTransport("smtps");
		transport.connect(host, username, password);
		transport.sendMessage(msg, msg.getAllRecipients());
		transport.close();
		
	}
}
